!function(t){t.fn.suggestionBox=function(n){function e(t){b.onClick(t),k.css("display","none"),O.val("")}function i(n){return t(n.target).parents("a").length>0||"A"===n.target.nodeName}function s(t){D=k.find("li:eq("+t+") a").attr("href"),k.find("li:eq("+t+")").addClass("selected")}function r(t){k.find("li:eq("+t+")").removeClass("selected")}function u(){D="#",T=-1,k.find("li").removeClass("selected")}function o(){var t=k.find("li").size();T===t-1?(r(T),u()):(r(T),T++,s(T))}function a(){T>0?(r(T),T--,s(T)):-1==T?(r(T),T=k.find("li").size()-1,s(T)):(r(0),u())}function c(){window.location=D}function f(n){I=O.val(),t.ajax({url:n,data:z,dataType:"json",success:function(t){var n=!0,e=T;A.results&&t.results&&(n=JSON.stringify(A.results[T])!==JSON.stringify(t.results[T])),S(t),y(),e>-1&&O.val()===I&&!n&&(T=e,s(T)),b.ajaxSuccess(t)},error:function(t){b.ajaxError(t)}})}function l(n){var e=t(n.target).parents("li");return e.parent().children().index(e)}function d(){var t=h(O,"border-bottom-width")+h(O,"border-top-width"),n=h(O,"padding-bottom")+h(O,"padding-top");k.css({position:"absolute",left:O.offset().left+b.leftOffset,top:O.offset().top+(O.height()+t+n+b.topOffset)})}function h(t,n){return parseInt(t.css(n).replace("px",""))}function g(){b.fadeOut?k.fadeOut():k.css("display","none"),u()}function v(){b.fadeIn?k.fadeIn():k.css("display","block")}function p(){var t=m()+b.widthAdjustment;"auto"==b.menuWidth?k.css({"min-width":t}):"constrain"==b.menuWidth&&k.css({width:t})}function m(){return O.width()+h(O,"border-left-width")+h(O,"border-right-width")+h(O,"padding-left")+h(O,"padding-right")}function w(n){var e='<div class="suggestion-header">'+b.heading+'</div> <ul class="suggestion-box-list">';return t.each(n.results,function(n,i){if(!i.suggestion||!i.url)return!1;U=!0;var s="";i.attr&&t.each(i.attr,function(t,n){for(var e=Object.keys(n),i=0;i<e.length;i++)s+=e[i]+'="'+n[e[i]]+'" '}),e+='<li><a href="'+i.url+'" '+s+">"+i.suggestion;for(var r=0;r<b.customValues.length;r++){var u=i[b.customValues[r]];u&&(e+=i[b.customValues[r]])}return e+="</a></li>",n===b.results-1?!1:void 0}),e+="</ul>"}function y(t){u(),U=!1;var n=b.filter?j(O.val()):A;if(n&&n.results)var e=w(n);V||t?U?(k.html(e),p(),v()):t?(b.showNoSuggestionsMessage&&k.html('<div class="no-suggestions">'+b.noSuggestionsMessage+"</div>"),p(),v()):b.showNoSuggestionsMessage&&O.val().length>0?(p(),v(),k.html('<div class="no-suggestions">'+b.noSuggestionsMessage+"</div>")):g():g()}function S(n){A=n?n instanceof Object?n:t.parseJSON(n):{}}function x(n){t.ajax({url:n,dataType:"json",success:function(t){S(t)},error:function(t){console.log(t)}})}function j(n){var e;if(n=n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),filterPattern=b.filterPattern.replace("{INPUT}",n),!n)return{};if(A&&A.results){var i=new RegExp(filterPattern,"i");e=t.grep(A.results,function(t){return i.test(t.suggestion)})}b.sort&&e.sort(b.sort);var s=JSON.stringify({results:e});return t.parseJSON(s)}var O=this,b=t.extend({topOffset:0,leftOffset:0,widthAdjustment:0,delay:400,heading:"Suggestions",results:10,fadeIn:!0,fadeOut:!1,menuWidth:"auto",showNoSuggestionsMessage:!1,noSuggestionsMessage:"No Suggestions Found",filter:!1,filterPattern:"({INPUT})",ajaxError:function(t){console.log(t)},ajaxSuccess:function(t){},onClick:function(t){c()},paramName:"search",customValues:[]},n),N="suggestion-box-"+Math.floor(1e7*Math.random());t("body").append('<div id="'+N+'" class="suggestion-box"></div>'),O.attr("autocomplete","off");var k=t("#"+N);d();var I,M=13,P=38,C=40,J=27,T=-1,D="#",E=!1,q=null,U=!1,V=!1,z={},A={};return k.on({mousemove:function(t){i(t)&&(r(T),T=l(t),s(T),E=!0)},mouseout:function(t){i(t)&&(E=!1,r(T),u())},click:function(t){i(t)&&(t.preventDefault(),e(t))}}),O.on({blur:function(){V=!1,E||g()},focus:function(){V=!0,t(this).val()&&y(A)},keyup:function(t){t.which!==P&&t.which!==C&&t.which!==J&&t.which!==M&&(b.url&&(u(),q&&clearTimeout(q)),b.url&&(z[b.paramName]=O.val(),q=setTimeout(function(){f(b.url)},b.delay)),b.filter&&y())},keydown:function(t){"none"!==k.css("display")&&(t.which==C&&(t.preventDefault(),o()),t.which==P&&(t.preventDefault(),a()),t.which===M&&T>-1&&(t.preventDefault(),k.find(".selected a").click()),t.which==J&&(t.preventDefault(),g()))},paste:function(){setTimeout(function(){O.keyup()},200)}}),t(window).resize(function(){d()}),{getSuggestions:function(t){return f(t),this},addSuggestions:function(t){return S(t),this},loadSuggestions:function(t){return x(t),this},getJson:function(){return JSON.stringify(A)},moveUp:function(){return a(),this},moveDown:function(){return o(),this},selectedUrl:function(){return D},selectedSuggestion:function(){return k.find("li:eq("+T+")").text()},position:function(){return T},select:function(t){return r(T),T=t,s(t),this},reset:function(){return r(T),u(),this},show:function(t){return t=t?t:!1,y(t),this},hide:function(){return g(),this},url:function(t){return b.url=t,this},fadeIn:function(t){return b.fadeIn=t,this},fadeOut:function(t){return b.fadeOut=t,this},delay:function(t){return b.delay=t,this},heading:function(t){return b.heading=t,this},results:function(t){return b.results=t,this},ajaxError:function(t){return b.ajaxError=t,this},ajaxSuccess:function(t){return b.ajaxSuccess=t,this},filter:function(t){return b.filter=t,this},filterPattern:function(t){return b.filterPattern=t,this},sort:function(t){return b.sort=t,this},onClick:function(t){return b.onClick=t,this},getId:function(t){return t?"#"+N:N},reservedKey:function(t){var n=t.which;return n===M||n===J||n===P||n===C},destroy:function(){return O.unbind(this),k.remove(),null}}}}(jQuery);
//# sourceMappingURL=maps/suggestion-box.min.js.map
