!function(t){t.fn.suggestionBox=function(n){function e(t){N.onClick(t),b.css("display","none"),j.val("")}function i(t){T=b.find("li:eq("+t+") a").attr("href"),b.find("li:eq("+t+")").addClass("selected")}function s(t){b.find("li:eq("+t+")").removeClass("selected")}function r(){T="#",J=-1,b.find("li").removeClass("selected")}function o(){var t=b.find("li").size();J===t-1?(s(J),r()):(s(J),J++,i(J))}function u(){J>0?(s(J),J--,i(J)):-1==J?(s(J),J=b.find("li").size()-1,i(J)):(s(0),r())}function a(){window.location=T}function f(n){k=j.val(),t.ajax({url:n,data:U,dataType:"json",success:function(t){var n=!0,e=J;z.results&&t.results&&(n=JSON.stringify(z.results[J])!==JSON.stringify(t.results[J])),y(t),w(),e>-1&&j.val()===k&&!n&&(J=e,i(J)),N.ajaxSuccess(t)},error:function(t){N.ajaxError(t)}})}function c(n){var e=t(n.target).parent("li");return e.parent().children().index(e)}function l(){var t=d(j,"border-bottom-width")+d(j,"border-top-width"),n=d(j,"padding-bottom")+d(j,"padding-top");b.css({position:"absolute",left:j.offset().left+N.leftOffset,top:j.offset().top+(j.height()+t+n+N.topOffset)})}function d(t,n){return parseInt(t.css(n).replace("px",""))}function h(){N.fadeOut?b.fadeOut():b.css("display","none"),r()}function g(){N.fadeIn?b.fadeIn():b.css("display","block")}function v(){var t=p()+N.widthAdjustment;"auto"==N.menuWidth?b.css({"min-width":t}):"constrain"==N.menuWidth&&b.css({width:t})}function p(){return j.width()+d(j,"border-left-width")+d(j,"border-right-width")+d(j,"padding-left")+d(j,"padding-right")}function m(n){var e='<div class="suggestion-header">'+N.heading+'</div> <ul class="suggestion-box-list">';return t.each(n.results,function(n,i){if(!i.suggestion||!i.url)return!1;E=!0;var s="";return i.attr&&t.each(i.attr,function(t,n){for(var e=Object.keys(n),i=0;i<e.length;i++)s+=e[i]+'="'+n[e[i]]+'" '}),e+='<li><a href="'+i.url+'" '+s+">"+i.suggestion+"</a></li>",n===N.results-1?!1:void 0}),e+="</ul>"}function w(t){r(),E=!1;var n=N.filter?x(j.val()):z;if(n&&n.results)var e=m(n);q||t?E?(b.html(e),v(),g()):t?(N.showNoSuggestionsMessage&&b.html('<div class="no-suggestions">'+N.noSuggestionsMessage+"</div>"),v(),g()):N.showNoSuggestionsMessage&&j.val().length>0?(v(),g(),b.html('<div class="no-suggestions">'+N.noSuggestionsMessage+"</div>")):h():h()}function y(n){z=n?n instanceof Object?n:t.parseJSON(n):{}}function S(n){t.ajax({url:n,dataType:"json",success:function(t){y(t)},error:function(t){console.log(t)}})}function x(n){var e;if(filterPattern=N.filterPattern.replace("{INPUT}",n),!n)return{};if(z&&z.results){var i=new RegExp(filterPattern,"i");e=t.grep(z.results,function(t){return i.test(t.suggestion)})}N.sort&&e.sort(N.sort);var s=JSON.stringify({results:e});return t.parseJSON(s)}var j=this,N=t.extend({topOffset:0,leftOffset:0,widthAdjustment:0,delay:400,heading:"Suggestions",results:10,fadeIn:!0,fadeOut:!1,menuWidth:"auto",showNoSuggestionsMessage:!1,noSuggestionsMessage:"No Suggestions Found",filter:!1,filterPattern:"({INPUT})",ajaxError:function(t){console.log(t)},ajaxSuccess:function(t){},onClick:function(t){a()},paramName:"search"},n),O="suggestion-box-"+Math.floor(1e7*Math.random());t("body").append('<div id="'+O+'" class="suggestion-box"></div>'),j.attr("autocomplete","off");var b=t("#"+O);l();var k,I=13,M=38,P=40,C=27,J=-1,T="#",D=!1,A=null,E=!1,q=!1,U={},z={};return b.on({mousemove:function(t){"A"===t.target.nodeName&&(s(J),J=c(t),i(J),D=!0)},mouseout:function(t){"A"===t.target.nodeName&&(D=!1,s(J),r())},click:function(t){"A"===t.target.nodeName&&(t.preventDefault(),e(t))}}),j.on({blur:function(){q=!1,D||h()},focus:function(){q=!0,t(this).val()&&w(z)},keyup:function(t){t.which!==M&&t.which!==P&&t.which!==C&&t.which!==I&&(N.url&&(r(),A&&clearTimeout(A)),N.url&&(U[N.paramName]=j.val(),A=setTimeout(function(){f(N.url)},N.delay)),N.filter&&w())},keydown:function(t){"none"!==b.css("display")&&(t.which==P&&(t.preventDefault(),o()),t.which==M&&(t.preventDefault(),u()),t.which===I&&J>-1&&(t.preventDefault(),b.find(".selected a").click()),t.which==C&&(t.preventDefault(),h()))},paste:function(){setTimeout(function(){j.keyup()},200)}}),t(window).resize(function(){l()}),{getSuggestions:function(t){return f(t),this},addSuggestions:function(t){return y(t),this},loadSuggestions:function(t){return S(t),this},getJson:function(){return JSON.stringify(z)},moveUp:function(){return u(),this},moveDown:function(){return o(),this},selectedUrl:function(){return T},selectedSuggestion:function(){return b.find("li:eq("+J+")").text()},position:function(){return J},select:function(t){return s(J),J=t,i(t),this},reset:function(){return s(J),r(),this},show:function(t){return t=t?t:!1,w(t),this},hide:function(){return h(),this},url:function(t){return N.url=t,this},fadeIn:function(t){return N.fadeIn=t,this},fadeOut:function(t){return N.fadeOut=t,this},delay:function(t){return N.delay=t,this},heading:function(t){return N.heading=t,this},results:function(t){return N.results=t,this},ajaxError:function(t){return N.ajaxError=t,this},ajaxSuccess:function(t){return N.ajaxSuccess=t,this},filter:function(t){return N.filter=t,this},filterPattern:function(t){return N.filterPattern=t,this},sort:function(t){return N.sort=t,this},onClick:function(t){return N.onClick=t,this},getId:function(t){return t?"#"+O:O},reservedKey:function(t){var n=t.which;return n===I||n===C||n===M||n===P?!0:!1},destroy:function(){return j.unbind(this),b.remove(),null}}}}(jQuery);
//# sourceMappingURL=maps/suggestion-box.min.js.map
