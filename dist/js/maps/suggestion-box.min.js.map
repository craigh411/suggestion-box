{"version":3,"sources":["suggestion-box.js"],"names":["$","fn","suggestionBox","options","moveDown","listSize","$suggestionBox","find","size","selectedLi","unselect","resetSelection","select","moveUp","goTo","window","location","selectedHref","getSuggestions","url","ajax","data","request","dataType","success","response","settings","ajaxSuccess","error","e","ajaxError","position","attr","addClass","removeClass","setSuggestionBoxPosition","borders","getCssValue","$searchBox","padding","css","left","offset","leftOffset","top","height","topOffset","element","name","parseInt","replace","hideSuggestionBox","fadeOut","showSuggestionBox","fadeIn","setSuggestionBoxWidth","searchBoxWidth","getSearchBoxWidth","menuWidth","min-width","width","showSuggestions","results","$suggestions","heading","each","key","value","suggestion","matches","document","activeElement","id","html","this","extend","delay","console","log","paramName","append","ENTER_KEY","UP_ARROW_KEY","DOWN_ARROW_KEY","ESCAPE_KEY","mouseHover","timer","on","mousemove","target","nodeName","$parentLi","parent","children","index","mouseout","blur","focus","val","keyup","which","clearTimeout","setTimeout","keydown","preventDefault","resize","suggestions","selectedLink","selectedSuggestion","reset","hide","show","destroy","jQuery"],"mappings":"CAAC,SAAUA,GAEPA,EAAEC,GAAGC,cAAgB,SAAUC,GA6E3B,QAASC,KACL,GAAIC,GAAWC,EAAeC,KAAK,MAAMC,MACrCC,KAAgBJ,EAAW,GAC3BK,EAASD,GACTE,MAEAD,EAASD,GACTA,IACAG,EAAOH,IAQf,QAASI,KACDJ,EAAa,GACbC,EAASD,GACTA,IACAG,EAAOH,IACc,IAAdA,GACPC,EAASD,GACTA,EAAaH,EAAeC,KAAK,MAAMC,OAAS,EAChDI,EAAOH,KAEPC,EAAS,GACTC,KAOR,QAASG,KACLC,OAAOC,SAAWC,EAOtB,QAASC,GAAeC,GACpBnB,EAAEoB,MACED,IAAKA,EACLE,KAAMC,EACNC,SAAU,OACVC,QAAS,SAAUH,GACfI,EAAWJ,EACXK,EAASC,YAAYN,IAEzBO,MAAO,SAAUC,GACbH,EAASI,UAAUD,MA4D/B,QAASjB,GAAOmB,GACZd,EAAeX,EAAeC,KAAK,SAAWwB,EAAW,OAAOC,KAAK,QACrE1B,EAAeC,KAAK,SAAWwB,EAAW,KAAKE,SAAS,YAO5D,QAASvB,GAASqB,GACdzB,EAAeC,KAAK,SAAWwB,EAAW,KAAKG,YAAY,YAM/D,QAASvB,KACLM,EAAe,IACfR,EAAa,GAMjB,QAAS0B,KACL,GAAIC,GAAUC,EAAYC,EAAY,uBAAyBD,EAAYC,EAAY,oBACnFC,EAAUF,EAAYC,EAAY,kBAAoBD,EAAYC,EAAY,cAElFhC,GAAekC,KACXT,SAAY,WACZU,KAASH,EAAWI,SAAa,KAAIhB,EAASiB,WAC9CC,IAAQN,EAAWI,SAAY,KAAKJ,EAAWO,SAAWT,EAAUG,EAAUb,EAASoB,aAU/F,QAAST,GAAYU,EAASC,GAC1B,MAAOC,UAASF,EAAQP,IAAIQ,GAAME,QAAQ,KAAM,KAMpD,QAASC,KACDzB,EAAS0B,QACT9C,EAAe8C,UAEf9C,EAAekC,IAAI,UAAW,QAElC7B,IAOJ,QAAS0C,KACD3B,EAAS4B,OACThD,EAAegD,SAEfhD,EAAekC,IAAI,UAAW,SAOtC,QAASe,KACL,GAAIC,GAAiBC,GAEK,SAAtB/B,EAASgC,UACTpD,EAAekC,KACXmB,YAAaH,IAEY,aAAtB9B,EAASgC,WAChBpD,EAAekC,KACXoB,MAASJ,IASrB,QAASC,KACL,MACInB,GAAWsB,QACXvB,EAAYC,EAAY,eACxBD,EAAYC,EAAY,gBACxBD,EAAYC,EAAY,gBACxBD,EAAYC,EAAY,iBACxBD,EAAY/B,EAAgB,eAC5B+B,EAAY/B,EAAgB,gBAC5B+B,EAAY/B,EAAgB,gBAC5B+B,EAAY/B,EAAgB,iBAQpC,QAASuD,GAAgBxC,GAIrB,GAHAV,IACAc,EAAWJ,EAEPA,EAAKyC,QAAS,CACd,GAAIC,GAAe,+BAAiCrC,EAASsC,QAAU,sCAGvEhE,GAAEiE,KAAK5C,EAAKyC,QAAS,SAAUI,EAAKC,GAShC,MARIA,GAAMC,YACNC,GAAU,EACVN,GAAgB,gBAAkBI,EAAMhD,IAAM,KAAOgD,EAAMC,WAAa,cAExEC,GAAU,EACV/D,EAAekC,IAAI,UAAW,SAG9B0B,IAASxC,EAASoC,QAAU,GACrB,EADX,SAKJC,GAAgB,QAEiB,UAA7BO,SAASC,cAAcC,GACnBH,IACA/D,EAAemE,KAAKV,GAEpBR,IACAF,KAGJF,KAxUZ,GAAIb,GAAaoC,KAEbhD,EAAW1B,EAAE2E,QAET7B,UAAW,EACXH,WAAY,EACZiC,MAAO,IACPZ,QAAS,cACTF,QAAS,GACTR,QAAQ,EACRF,SAAS,EACTM,UAAW,OACX5B,UAAW,SAAUD,GACjBgD,QAAQC,IAAIjD,IAEhBF,YAAa,SAAUN,GACnBwC,EAAgBxC,GAChBwD,QAAQC,IAAIzD,IAEhB0D,UAAW,UAEf5E,EAIJH,GAAE,QAAQgF,OAAO,mCAEjB1C,EAAWN,KAAK,eAAgB,MAEhC,IAAI1B,GAAiBN,EAAE,kBACvBmC,IAGA,MAAM8C,GAAY,GACZC,EAAe,GACfC,EAAiB,GACjBC,EAAa,EAGnB,IAWI3D,GAXAhB,EAAa,GACbQ,EAAe,IAGfoE,GAAa,EAEbC,EAAQ,KAERjB,GAAU,EAEV/C,IA6RJ,OA1RAhB,GAAeiF,IACXC,UAAa,SAAU3D,GACnB,GAA0B,MAAtBA,EAAE4D,OAAOC,SAAkB,CAC3B1F,EAAE0E,MAAMnE,KAAK,MAAM2B,YAAY,WAC/B,IAAIyD,GAAY3F,EAAE6B,EAAE4D,QAAQG,OAAO,KACnCnF,GAAakF,EAAUC,SAASC,WAAWC,MAAMH,GACjD/E,EAAOH,GACP4E,GAAa,IAGrBU,SAAY,SAAUlE,GACQ,MAAtBA,EAAE4D,OAAOC,WACTL,GAAa,EACb3E,EAASD,GACTE,QAmEZ2B,EAAWiD,IACPS,KAAQ,WAECX,GACDlC,KAGR8C,MAAS,WACDjG,EAAE0E,MAAMwB,OACR7C,KAGR8C,MAAS,SAAUtE,GAEXA,EAAEuE,QAAUlB,GAAgBrD,EAAEuE,QAAUjB,GAAkBtD,EAAEuE,QAAUhB,IAClEE,GACAe,aAAaf,GAGjBhE,EAAQI,EAASqD,WAAazC,EAAW4D,MACzCZ,EAAQgB,WAAWpF,EAAeQ,EAASP,KAAMO,EAASkD,SAGlE2B,QAAW,SAAU1E,GACqB,SAAlCvB,EAAekC,IAAI,aACfX,EAAEuE,OAASjB,IACXtD,EAAE2E,iBACFpG,KAEAyB,EAAEuE,OAASlB,IACXrD,EAAE2E,iBACF3F,KAEAgB,EAAEuE,QAAUnB,GAA8B,MAAjBhE,IACzBY,EAAE2E,iBACF1F,KAEAe,EAAEuE,OAAShB,IACXvD,EAAE2E,iBACFrD,SAOhBnD,EAAEe,QAAQ0F,OAAO,WACbtE,OA2JAjB,eAAgB,SAAUC,GAEtB,MADAD,GAAeC,GACRuD,MAEXb,gBAAiB,SAAU6C,GAEvB,MADA7C,GAAgB6C,GACThC,MAEX7D,OAAQ,WAEJ,MADAA,KACO6D,MAEXtE,SAAU,WAEN,MADAA,KACOsE,MAEXiC,aAAc,WACV,MAAO1F,IAEX2F,mBAAoB,aAGpB7E,SAAU,WACN,MAAOtB,IAEXgB,SAAU,WACN,MAAOA,IAEXb,OAAQ,SAAUmB,GAEd,MADAnB,GAAOmB,GACA2C,MAEXhE,SAAU,SAAUqB,GAEhB,MADArB,GAASqB,GACF2C,MAEXmC,MAAO,WAGH,MAFAnG,GAASD,GACTE,IACO+D,MAEXoC,KAAM,WAEF,MADA3D,KACOuB,MAEXqC,KAAM,WAEF,MADA1D,KACOqB,MAEXpB,OAAQ,SAAUA,GAEd,MADA5B,GAAS4B,OAASA,EACXoB,MAEXtB,QAAS,SAAUA,GAEf,MADA1B,GAAS0B,QAAUA,EACZsB,MAEXE,MAAO,SAAUA,GAEb,MADAlD,GAASkD,MAAQA,EACVF,MAEXV,QAAS,SAAUA,GAEf,MADAtC,GAASsC,QAAUA,EACZU,MAEXZ,QAAS,SAAUA,GAEf,MADApC,GAASoC,QAAUA,EACZY,MAEX5C,UAAW,SAAUA,GAEjB,MADAJ,GAASI,UAAYA,EACd4C,MAEX/C,YAAa,SAAUA,GAEnB,MADAD,GAASC,YAAcA,EAChB+C,MAEXsC,QAAS,gBAInBC","file":"suggestion-box.min.js","sourcesContent":["(function ($) {\r\n\r\n    $.fn.suggestionBox = function (options) {\r\n        var $searchBox = this;\r\n\r\n        var settings = $.extend({\r\n                // default settings.\r\n                topOffset: 0,\r\n                leftOffset: 0,\r\n                delay: 400, // in ms\r\n                heading: 'Suggestions',\r\n                results: 10,\r\n                fadeIn: true,\r\n                fadeOut: false,\r\n                menuWidth: 'auto',\r\n                ajaxError: function (e) {\r\n                    console.log(e);\r\n                },\r\n                ajaxSuccess: function (data) {\r\n                    showSuggestions(data);\r\n                    console.log(data);\r\n                },\r\n                paramName: 'search'\r\n            },\r\n            options);\r\n\r\n\r\n        // Inject the suggestion box into the body of the web page\r\n        $('body').append('<div id=\"suggestion-box\"></div>');\r\n        // Turn off autocomplete\r\n        $searchBox.attr('autocomplete', 'off');\r\n\r\n        var $suggestionBox = $('#suggestion-box');\r\n        setSuggestionBoxPosition();\r\n\r\n        // Constants for key values\r\n        const ENTER_KEY = 13;\r\n        const UP_ARROW_KEY = 38;\r\n        const DOWN_ARROW_KEY = 40;\r\n        const ESCAPE_KEY = 27;\r\n\r\n        // Default values for selected list item\r\n        var selectedLi = -1;\r\n        var selectedHref = '#';\r\n\r\n        // Is the mouse hovering over the suggestion box?\r\n        var mouseHover = false;\r\n        // Timer for only making ajax calls when the user stops typing\r\n        var timer = null;\r\n        // Did we get any suggestions?\r\n        var matches = false;\r\n        // create a blank object for our request\r\n        var request = {};\r\n        var response;\r\n\r\n        $suggestionBox.on({\r\n            'mousemove': function (e) {\r\n                if (e.target.nodeName === 'A') {\r\n                    $(this).find('li').removeClass('selected');\r\n                    var $parentLi = $(e.target).parent('li');\r\n                    selectedLi = $parentLi.parent().children().index($parentLi);\r\n                    select(selectedLi);\r\n                    mouseHover = true;\r\n                }\r\n            },\r\n            'mouseout': function (e) {\r\n                if (e.target.nodeName === 'A') {\r\n                    mouseHover = false;\r\n                    unselect(selectedLi);\r\n                    resetSelection();\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n        /**\r\n         * Moves the selection down to the next suggestion\r\n         * @param e\r\n         */\r\n        function moveDown() {\r\n            var listSize = $suggestionBox.find('li').size();\r\n            if (selectedLi === (listSize - 1)) {\r\n                unselect(selectedLi);\r\n                resetSelection();\r\n            } else {\r\n                unselect(selectedLi);\r\n                selectedLi++;\r\n                select(selectedLi);\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Moves the selection up to the previous suggestions\r\n         * @param e\r\n         */\r\n        function moveUp() {\r\n            if (selectedLi > 0) {\r\n                unselect(selectedLi);\r\n                selectedLi--;\r\n                select(selectedLi);\r\n            } else if (selectedLi == -1) {\r\n                unselect(selectedLi);\r\n                selectedLi = $suggestionBox.find('li').size() - 1;\r\n                select(selectedLi);\r\n            } else {\r\n                unselect(0);\r\n                resetSelection();\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Redirects the user to the selected suggestion location\r\n         */\r\n        function goTo() {\r\n            window.location = selectedHref;\r\n        }\r\n\r\n        /**\r\n         * Makes an ajax call to the given url\r\n         * @param url\r\n         */\r\n        function getSuggestions(url) {\r\n            $.ajax({\r\n                url: url,\r\n                data: request,\r\n                dataType: 'json',\r\n                success: function (data) {\r\n                    response = data;\r\n                    settings.ajaxSuccess(data);\r\n                },\r\n                error: function (e) {\r\n                    settings.ajaxError(e);\r\n                }\r\n            });\r\n        }\r\n\r\n        $searchBox.on({\r\n            'blur': function () {\r\n                // Only close the menu if we are not clicking a link\r\n                if (!mouseHover) {\r\n                    hideSuggestionBox();\r\n                }\r\n            },\r\n            'focus': function () {\r\n                if ($(this).val()) {\r\n                    showSuggestionBox();\r\n                }\r\n            },\r\n            'keyup': function (e) {\r\n                // Ignore the navigation keys. We don't want to fire ajax calls when navigating\r\n                if (e.which !== UP_ARROW_KEY && e.which !== DOWN_ARROW_KEY && e.which !== ESCAPE_KEY) {\r\n                    if (timer) {\r\n                        clearTimeout(timer);\r\n                    }\r\n                    // set the request to be sent sent as the data parameter\r\n                    request[settings.paramName] = $searchBox.val();\r\n                    timer = setTimeout(getSuggestions(settings.url), settings.delay);\r\n                }\r\n            },\r\n            'keydown': function (e) {\r\n                if ($suggestionBox.css('display') !== 'none') {\r\n                    if (e.which == DOWN_ARROW_KEY) {\r\n                        e.preventDefault();\r\n                        moveDown();\r\n                    }\r\n                    if (e.which == UP_ARROW_KEY) {\r\n                        e.preventDefault();\r\n                        moveUp();\r\n                    }\r\n                    if (e.which === ENTER_KEY && selectedHref !== '#') {\r\n                        e.preventDefault();\r\n                        goTo();\r\n                    }\r\n                    if (e.which == ESCAPE_KEY) {\r\n                        e.preventDefault();\r\n                        hideSuggestionBox();\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        // Reset the position of the suggestion box if the window is re-sized\r\n        $(window).resize(function () {\r\n            setSuggestionBoxPosition();\r\n        });\r\n\r\n\r\n        /**\r\n         * Selects the suggestion at the given position\r\n         * @param position\r\n         */\r\n        function select(position) {\r\n            selectedHref = $suggestionBox.find(\"li:eq(\" + position + \") a\").attr('href');\r\n            $suggestionBox.find(\"li:eq(\" + position + \")\").addClass('selected');\r\n        }\r\n\r\n        /**\r\n         * Unselects the suggestion at the given position\r\n         * @param position\r\n         */\r\n        function unselect(position) {\r\n            $suggestionBox.find(\"li:eq(\" + position + \")\").removeClass('selected');\r\n        }\r\n\r\n        /**\r\n         * Resets any selected suggestions\r\n         */\r\n        function resetSelection() {\r\n            selectedHref = '#';\r\n            selectedLi = -1;\r\n        }\r\n\r\n        /**\r\n         * Sets the position of the suggestion box\r\n         */\r\n        function setSuggestionBoxPosition() {\r\n            var borders = getCssValue($searchBox, 'border-bottom-width') + getCssValue($searchBox, 'border-top-width');\r\n            var padding = getCssValue($searchBox, 'padding-bottom') + getCssValue($searchBox, 'padding-top');\r\n\r\n            $suggestionBox.css({\r\n                'position': 'absolute',\r\n                'left': ($searchBox.offset().left) + settings.leftOffset,\r\n                'top': ($searchBox.offset().top) + ($searchBox.height() + borders + padding + settings.topOffset)\r\n            });\r\n        }\r\n\r\n        /**\r\n         * Gets the css integer value for the given element.\r\n         * @param element\r\n         * @param name\r\n         * @returns {Number}\r\n         */\r\n        function getCssValue(element, name) {\r\n            return parseInt(element.css(name).replace('px', ''));\r\n        }\r\n\r\n        /**\r\n         * Hides the suggestion box\r\n         */\r\n        function hideSuggestionBox() {\r\n            if (settings.fadeOut) {\r\n                $suggestionBox.fadeOut();\r\n            } else {\r\n                $suggestionBox.css('display', 'none');\r\n            }\r\n            resetSelection();\r\n        }\r\n\r\n\r\n        /**\r\n         * Displays the suggestion-box\r\n         */\r\n        function showSuggestionBox() {\r\n            if (settings.fadeIn) {\r\n                $suggestionBox.fadeIn();\r\n            } else {\r\n                $suggestionBox.css('display', 'block');\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Sets the width of the suggestion box\r\n         */\r\n        function setSuggestionBoxWidth() {\r\n            var searchBoxWidth = getSearchBoxWidth();\r\n\r\n            if (settings.menuWidth == 'auto') {\r\n                $suggestionBox.css({\r\n                    'min-width': searchBoxWidth\r\n                });\r\n            } else if (settings.menuWidth == 'constrain') {\r\n                $suggestionBox.css({\r\n                    'width': searchBoxWidth\r\n                });\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Returns the width of the search box\r\n         * @returns {number}\r\n         */\r\n        function getSearchBoxWidth() {\r\n            return (\r\n                $searchBox.width() +\r\n                getCssValue($searchBox, 'border-left') +\r\n                getCssValue($searchBox, 'border-right') +\r\n                getCssValue($searchBox, 'padding-left') +\r\n                getCssValue($searchBox, 'padding-right') -\r\n                getCssValue($suggestionBox, 'border-left') -\r\n                getCssValue($suggestionBox, 'border-right') -\r\n                getCssValue($suggestionBox, 'padding-left') -\r\n                getCssValue($suggestionBox, 'padding-right')\r\n            );\r\n        }\r\n\r\n        /**\r\n         * Shows the suggestion-box suggestions if they are available based on the data passed in\r\n         * @param data\r\n         */\r\n        function showSuggestions(data) {\r\n            resetSelection();\r\n            response = data;\r\n\r\n            if (data.results) {\r\n                var $suggestions = '<div id=\"suggestion-header\">' + settings.heading + '</div> ' +\r\n                    '<ul id=\"suggestion-box-list\">';\r\n\r\n                $.each(data.results, function (key, value) {\r\n                    if (value.suggestion) {\r\n                        matches = true;\r\n                        $suggestions += '<li><a href=\"' + value.url + '\">' + value.suggestion + '</a></li>';\r\n                    } else {\r\n                        matches = false;\r\n                        $suggestionBox.css('display', 'none');\r\n                    }\r\n\r\n                    if (key === (settings.results - 1)) {\r\n                        return false;\r\n                    }\r\n                });\r\n\r\n                $suggestions += '</ul>';\r\n                // Check for focus before showing suggestion box. User could have clicked outside before request finished.\r\n                if (document.activeElement.id == 'search') {\r\n                    if (matches) {\r\n                        $suggestionBox.html($suggestions);\r\n\r\n                        setSuggestionBoxWidth();\r\n                        showSuggestionBox();\r\n                    }\r\n                } else {\r\n                    hideSuggestionBox();\r\n                }\r\n            }\r\n        }\r\n\r\n        // returned methods\r\n        return {\r\n            getSuggestions: function (url) {\r\n                getSuggestions(url);\r\n                return this;\r\n            },\r\n            showSuggestions: function (suggestions) {\r\n                showSuggestions(suggestions);\r\n                return this;\r\n            },\r\n            moveUp: function () {\r\n                moveUp();\r\n                return this;\r\n            },\r\n            moveDown: function () {\r\n                moveDown();\r\n                return this;\r\n            },\r\n            selectedLink: function () {\r\n                return selectedHref;\r\n            },\r\n            selectedSuggestion: function () {\r\n                return;\r\n            },\r\n            position: function () {\r\n                return selectedLi;\r\n            },\r\n            response: function () {\r\n                return response;\r\n            },\r\n            select: function (position) {\r\n                select(position);\r\n                return this;\r\n            },\r\n            unselect: function (position) {\r\n                unselect(position);\r\n                return this;\r\n            },\r\n            reset: function () {\r\n                unselect(selectedLi);\r\n                resetSelection();\r\n                return this;\r\n            },\r\n            hide: function () {\r\n                hideSuggestionBox();\r\n                return this;\r\n            },\r\n            show: function () {\r\n                showSuggestionBox();\r\n                return this;\r\n            },\r\n            fadeIn: function (fadeIn) {\r\n                settings.fadeIn = fadeIn;\r\n                return this;\r\n            },\r\n            fadeOut: function (fadeOut) {\r\n                settings.fadeOut = fadeOut;\r\n                return this;\r\n            },\r\n            delay: function (delay) {\r\n                settings.delay = delay;\r\n                return this;\r\n            },\r\n            heading: function (heading) {\r\n                settings.heading = heading;\r\n                return this;\r\n            },\r\n            results: function (results) {\r\n                settings.results = results;\r\n                return this;\r\n            },\r\n            ajaxError: function (ajaxError) {\r\n                settings.ajaxError = ajaxError;\r\n                return this;\r\n            },\r\n            ajaxSuccess: function (ajaxSuccess) {\r\n                settings.ajaxSuccess = ajaxSuccess;\r\n                return this;\r\n            },\r\n            destroy: function () {\r\n            }\r\n        };\r\n    };\r\n}(jQuery));"],"sourceRoot":"/source/"}